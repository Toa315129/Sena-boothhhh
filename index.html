<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>SENA PHOTOBOOTH</title>

<!-- ===============================
 KOREAN SELF PHOTO STUDIO STYLE
 Designed for iPad Portrait Mode
 Single File – Full System
================================ -->

<style>
/* ------------------------------
   ROOT COLOR SYSTEM
------------------------------ */
:root{
  --milk:#fffdf9;
  --cream:#f6f1ea;
  --pink:#fde6ef;
  --blue:#e9f3ff;
  --text:#333;
  --line:rgba(0,0,0,.08);
  --shadow:0 20px 50px rgba(0,0,0,.08);
}

/* ------------------------------
   GLOBAL RESET
------------------------------ */
*{
  box-sizing:border-box;
  -webkit-tap-highlight-color: transparent;
}

html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  font-family:-apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
  background:var(--milk);
  color:var(--text);
  overflow:hidden;
}

/* ------------------------------
   APP CONTAINER
------------------------------ */
#app{
  width:100%;
  height:100%;
  position:relative;
}

/* ------------------------------
   STAR DECORATION (8 POINT)
------------------------------ */
.star{
  position:absolute;
  width:10px;
  height:10px;
  background:radial-gradient(circle,var(--pink),transparent 70%);
  transform:rotate(45deg);
  opacity:.6;
}

/* ------------------------------
   START SCREEN
------------------------------ */
#startScreen{
  position:absolute;
  inset:0;
  background:linear-gradient(160deg,var(--pink),var(--blue));
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:40px;
  transition:opacity .8s ease;
}

#startScreen h1{
  letter-spacing:4px;
  font-weight:300;
  font-size:38px;
}

.start-btn{
  width:160px;
  height:160px;
  border-radius:50%;
  background:white;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  letter-spacing:2px;
  box-shadow:var(--shadow);
  cursor:pointer;
  animation:pulse 2.5s infinite;
}

@keyframes pulse{
  0%{transform:scale(1);}
  50%{transform:scale(1.05);}
  100%{transform:scale(1);}
}

/* ------------------------------
   BOOTH SCREEN
------------------------------ */
#boothScreen{
  position:absolute;
  inset:0;
  background:var(--milk);
  display:none;
  padding:16px;
}

/* ------------------------------
   CAMERA PREVIEW
------------------------------ */
.camera-wrap{
  position:relative;
  width:100%;
  height:60%;
  border-radius:26px;
  overflow:hidden;
  background:black;
  box-shadow:var(--shadow);
}

video{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* guideline */
.guide{
  position:absolute;
  inset:10%;
  border:1px dashed rgba(255,255,255,.4);
  border-radius:20px;
}

/* ------------------------------
   COUNTDOWN
------------------------------ */
#countdown{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:120px;
  color:white;
  opacity:0;
  transition:.3s;
}

/* ------------------------------
   PREVIEW STRIP
------------------------------ */
.preview-strip{
  display:flex;
  gap:10px;
  margin:12px 0;
}

.preview-strip img{
  width:80px;
  height:110px;
  object-fit:cover;
  border-radius:12px;
  box-shadow:var(--shadow);
  transform:translateY(20px);
  opacity:0;
  transition:.6s ease;
}

.preview-strip img.show{
  transform:translateY(0);
  opacity:1;
}

/* ------------------------------
   CONTROLS
------------------------------ */
.controls{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.btn{
  padding:14px 22px;
  border-radius:30px;
  background:white;
  box-shadow:var(--shadow);
  border:none;
  font-size:14px;
}

.capture{
  width:80px;
  height:80px;
  border-radius:50%;
  background:linear-gradient(145deg,#fff,#f1f1f1);
  border:4px solid #eee;
}

/* ------------------------------
   STATUS LIGHT
------------------------------ */
.status{
  font-size:12px;
}

/* ------------------------------
   FILM RESULT
------------------------------ */
#film{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
}

.film-paper{
  background:white;
  padding:20px;
  border-radius:20px;
  width:300px;
}

.film-paper h2{
  text-align:center;
  font-weight:300;
  letter-spacing:2px;
}

.film-paper img{
  width:100%;
  margin:6px 0;
  border-radius:8px;
}
</style>
</head>

<body>
<div id="app">

  <!-- ⭐ decoration -->
  <div class="star" style="top:10%;left:20%"></div>
  <div class="star" style="top:30%;right:25%"></div>

  <!-- ================= START SCREEN ================= -->
  <div id="startScreen">
    <h1>SENA PHOTOBOOTH</h1>
    <div class="start-btn" id="startBtn">START</div>
  </div>

  <!-- ================= BOOTH SCREEN ================= -->
  <div id="boothScreen">

    <div class="camera-wrap">
      <video id="video" autoplay playsinline></video>
      <div class="guide"></div>
      <div id="countdown">3</div>
    </div>

    <div class="preview-strip" id="previews"></div>

    <div class="controls">
      <button class="btn" id="cameraToggle">Camera ON</button>
      <button class="capture" id="captureBtn"></button>
      <button class="btn" id="modeBtn">Color</button>
    </div>

    <div class="status" id="status">● Camera ON</div>
  </div>

  <!-- ================= FILM RESULT ================= -->
  <div id="film">
    <div class="film-paper">
      <h2>SENAPHOTOBOOTH</h2>
      <div id="filmImages"></div>
      <button class="btn" id="downloadBtn">Download</button>
      <button class="btn" id="resetBtn">Reset</button>
    </div>
  </div>

</div>

<script>
/* =====================================
   GLOBAL STATE
===================================== */
const video = document.getElementById('video');
const startBtn = document.getElementById('startBtn');
const booth = document.getElementById('boothScreen');
const startScreen = document.getElementById('startScreen');
const captureBtn = document.getElementById('captureBtn');
const previews = document.getElementById('previews');
const countdownEl = document.getElementById('countdown');
const film = document.getElementById('film');
const filmImages = document.getElementById('filmImages');
const modeBtn = document.getElementById('modeBtn');
const statusEl = document.getElementById('status');

let stream;
let shots = [];
let mono = false;

/* =====================================
   AUDIO (Soft Korean Style)
===================================== */
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();

function beep(){
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.frequency.value = 800;
  g.gain.value = .03;
  o.connect(g).connect(audioCtx.destination);
  o.start();
  o.stop(audioCtx.currentTime + .1);
}

function shutter(){
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type="triangle";
  o.frequency.value=120;
  g.gain.value=.05;
  o.connect(g).connect(audioCtx.destination);
  o.start();
  o.stop(audioCtx.currentTime+.15);
}

/* =====================================
   CAMERA
===================================== */
async function openCamera(){
  stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});
  video.srcObject = stream;
}

/* =====================================
   COUNTDOWN + CAPTURE
===================================== */
async function takeSequence(){
  shots=[];
  previews.innerHTML="";
  for(let i=0;i<3;i++){
    await countdown();
    capture();
  }
  showFilm();
}

function countdown(){
  return new Promise(res=>{
    let n=3;
    countdownEl.style.opacity=1;
    const iv=setInterval(()=>{
      countdownEl.textContent=n;
      beep();
      n--;
      if(n<0){
        clearInterval(iv);
        countdownEl.style.opacity=0;
        res();
      }
    },700);
  });
}

function capture(){
  shutter();
  const c=document.createElement("canvas");
  c.width=video.videoWidth;
  c.height=video.videoHeight;
  const ctx=c.getContext("2d");
  if(mono){
    ctx.filter="grayscale(1)";
  }
  ctx.drawImage(video,0,0);
  const img=c.toDataURL("image/png");
  shots.push(img);

  const p=document.createElement("img");
  p.src=img;
  previews.appendChild(p);
  setTimeout(()=>p.classList.add("show"),50);
}

/* =====================================
   FILM
===================================== */
function showFilm(){
  filmImages.innerHTML="";
  shots.forEach(s=>{
    const i=document.createElement("img");
    i.src=s;
    filmImages.appendChild(i);
  });
  film.style.display="flex";
}

/* =====================================
   EVENTS
===================================== */
startBtn.onclick=async()=>{
  await openCamera();
  startScreen.style.opacity=0;
  setTimeout(()=>{
    startScreen.style.display="none";
    booth.style.display="block";
  },800);
};

captureBtn.onclick=()=>{
  if(shots.length===0) takeSequence();
};

modeBtn.onclick=()=>{
  mono=!mono;
  modeBtn.textContent= mono ? "Mono" : "Color";
};

document.getElementById("downloadBtn").onclick=()=>{
  const a=document.createElement("a");
  a.href=shots[0];
  a.download="SENA_PHOTO.png";
  a.click();
};

document.getElementById("resetBtn").onclick=()=>{
  location.reload();
};
</script>
</body>
</html>
