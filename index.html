<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>SENA PHOTOBOOTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background:#f6f5f2;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    color:#222;
}

.star{position:fixed;color:#bbb;font-size:14px;}
.star:nth-child(1){top:30px;left:40px;}
.star:nth-child(2){top:90px;right:60px;}
.star:nth-child(3){bottom:60px;left:80px;}

.screen{display:none;flex-direction:column;align-items:center;}
.active{display:flex;}

h1{letter-spacing:3px;margin-bottom:20px;}

button{
    padding:14px 36px;
    margin:8px;
    font-size:18px;
    border-radius:12px;
    border:1px solid #ccc;
    background:#fff;
}

.primary{
    background:#111;
    color:#fff;
    border:none;
}

.layout-preview{
    width:120px;
    height:240px;
    border:1px solid #ccc;
    background:white;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    padding:8px;
}

.layout-preview div{
    flex:1;
    border:1px solid #ddd;
    margin:4px 0;
    background:#eee;
}

.camera{
    width:320px;
    aspect-ratio:3/4;
    background:black;
    border-radius:16px;
    overflow:hidden;
}

video,canvas{
    width:100%;
    height:100%;
    object-fit:cover;
}

#final{
    background:white;
    border-radius:16px;
    box-shadow:0 10px 30px rgba(0,0,0,.2);
}
</style>
</head>

<body>

<div class="star">✦</div>
<div class="star">✦</div>
<div class="star">✦</div>

<!-- เลือก Layout -->
<div id="layout" class="screen active">
    <h1>LAYOUT</h1>
    <div class="layout-preview" onclick="selectLayout()">
        <div></div><div></div><div></div><div></div>
    </div>
    <button class="primary" onclick="show('mode')">NEXT</button>
</div>

<!-- เลือกโหมด -->
<div id="mode" class="screen">
    <h1>MODE</h1>
    <button onclick="setMode('color')">COLOR</button>
    <button onclick="setMode('mono')">MONO</button>
</div>

<!-- กล้อง -->
<div id="booth" class="screen">
    <h1>SENA PHOTOBOOTH</h1>
    <div class="camera">
        <video id="video" autoplay playsinline></video>
    </div>
    <button class="primary" onclick="takePhoto()">TAKE PHOTO</button>
</div>

<!-- ผลลัพธ์ -->
<div id="result" class="screen">
    <h1>RESULT</h1>
    <canvas id="final" width="600" height="1600"></canvas>
    <button onclick="reset()">FINISH</button>
</div>

<script>
let mode="color";
const video=document.getElementById("video");
const final=document.getElementById("final");
const fctx=final.getContext("2d");

function show(id){
    document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

function selectLayout(){}

function setMode(m){
    mode=m;
    show('booth');
    navigator.mediaDevices.getUserMedia({video:true})
    .then(s=>video.srcObject=s);
}

function takePhoto(){
    const temp=document.createElement("canvas");
    temp.width=video.videoWidth;
    temp.height=video.videoHeight;
    const tctx=temp.getContext("2d");
    tctx.drawImage(video,0,0);

    if(mode==="mono"){
        let img=tctx.getImageData(0,0,temp.width,temp.height);
        for(let i=0;i<img.data.length;i+=4){
            let a=(img.data[i]+img.data[i+1]+img.data[i+2])/3;
            img.data[i]=img.data[i+1]=img.data[i+2]=a;
        }
        tctx.putImageData(img,0,0);
    }

    // วาด strip (รูปเดียวซ้ำ 4 ช่อง)
    show('result');
    fctx.fillStyle="#fff";
    fctx.fillRect(0,0,600,1600);

    let y=60;
    for(let i=0;i<4;i++){
        fctx.drawImage(temp,60,y,480,300);
        y+=360;
    }

    fctx.fillStyle="#000";
    fctx.font="24px Arial";
    fctx.textAlign="center";
    fctx.fillText("✦ SENA PHOTOBOOTH ✦",300,1540);
}

function reset(){
    show('layout');
}
</script>

</body>
</html>
