<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>SENA PHOTOBOOTH</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
:root{
  --white:#ffffff;
  --cream:#fffaf2;
  --blue:#e9f2ff;
  --blue-dark:#7aa7e9;
  --text:#1f2a44;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:var(--cream);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  color:var(--text);
}

.screen{display:none;}
.active{display:flex;}

.container{
  width:900px;
  background:var(--white);
  border-radius:32px;
  padding:24px 32px 32px;
  box-shadow:0 30px 60px rgba(0,0,0,.15);
  flex-direction:column;
  align-items:center;
}

.header{
  font-weight:600;
  letter-spacing:3px;
  margin-bottom:20px;
}
.header span{color:var(--blue-dark);}

.main{
  display:flex;
  gap:32px;
  align-items:center;
}

/* ---------- CAMERA ---------- */
.camera-wrap{
  background:var(--blue);
  border-radius:180px 180px 28px 28px;
  padding:18px;
  box-shadow:0 20px 40px rgba(0,0,0,.15);
  position:relative;
}

.camera{
  width:360px;
  height:480px;
  border-radius:160px 160px 22px 22px;
  overflow:hidden;
  background:black;
}

video{
  width:100%;
  height:100%;
  object-fit:cover;
}

#countdown{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:96px;
  color:white;
  display:none;
}

/* ---------- STRIP PREVIEW ---------- */
.strip{
  background:var(--cream);
  border-radius:24px;
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.frame{
  width:140px;
  height:200px;
  background:white;
  border-radius:14px;
  box-shadow:0 6px 16px rgba(0,0,0,.12);
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  color:#aaa;
}

/* ---------- BUTTON ---------- */
button{
  margin-top:24px;
  padding:16px 56px;
  font-size:18px;
  border-radius:999px;
  border:none;
  font-family:'Poppins',sans-serif;
  background:var(--blue-dark);
  color:white;
  box-shadow:0 10px 24px rgba(0,0,0,.2);
}

button:active{transform:scale(.96);}

/* ---------- RESULT ---------- */
#final{
  background:white;
  border-radius:24px;
  box-shadow:0 20px 40px rgba(0,0,0,.25);
}
.actions{
  display:flex;
  gap:16px;
  margin-top:20px;
}
</style>
</head>

<body>

<!-- HOME -->
<div id="home" class="screen active container">
  <div class="header">✨ SENA <span>PHOTOBOOTH</span> ✦</div>
  <button onclick="selectMode('color')">START ✨</button>
</div>

<!-- BOOTH -->
<div id="booth" class="screen container">
  <div class="header">✦ SENA <span>PHOTOBOOTH</span> ✦</div>

  <div class="main">
    <!-- Camera -->
    <div class="camera-wrap">
      <div class="camera">
        <video id="video" autoplay playsinline></video>
      </div>
      <div id="countdown">3</div>
    </div>

    <!-- Strip Preview -->
    <div class="strip">
      <canvas class="frame" width="140" height="200"></canvas>
      <canvas class="frame" width="140" height="200"></canvas>
      <canvas class="frame" width="140" height="200"></canvas>
      <canvas class="frame" width="140" height="200"></canvas>
    </div>
  </div>

  <button onclick="startSession()">TAKE PHOTO ✨</button>
</div>

<!-- RESULT -->
<div id="result" class="screen container">
  <div class="header">⭐ YOUR PHOTO ⭐</div>
  <canvas id="final" width="600" height="1600"></canvas>
  <div class="actions">
    <button onclick="download()">DOWNLOAD</button>
    <button onclick="reset()">FINISH</button>
  </div>
</div>

<script>
let shots=[];
let index=0;

const video=document.getElementById("video");
const frames=document.querySelectorAll(".frame");
const cd=document.getElementById("countdown");
const final=document.getElementById("final");
const fctx=final.getContext("2d");

function show(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function selectMode(){
  show("booth");
  navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}})
    .then(s=>video.srcObject=s);
}

function startSession(){
  shots=[];
  index=0;
  frames.forEach(f=>f.getContext("2d").clearRect(0,0,140,200));
  takeNext();
}

function takeNext(){
  if(index>=4){ makeFinal(); return; }
  let c=3;
  cd.style.display="flex";
  cd.innerText=c;
  let t=setInterval(()=>{
    c--;
    cd.innerText=c;
    if(c===0){
      clearInterval(t);
      cd.style.display="none";
      capture();
    }
  },1000);
}

function capture(){
  const temp=document.createElement("canvas");
  temp.width=video.videoWidth;
  temp.height=video.videoHeight;
  const tctx=temp.getContext("2d");
  tctx.drawImage(video,0,0);

  shots.push(temp);

  const pctx=frames[index].getContext("2d");
  pctx.drawImage(temp,0,0,140,200);

  index++;
  setTimeout(takeNext,500);
}

function makeFinal(){
  show("result");
  fctx.fillStyle="#fff";
  fctx.fillRect(0,0,600,1600);
  let y=80;
  shots.forEach(s=>{
    fctx.drawImage(s,60,y,480,300);
    y+=340;
  });
  fctx.fillStyle="#000";
  fctx.font="22px Poppins";
  fctx.textAlign="center";
  fctx.fillText("SENA PHOTOBOOTH ✦",300,1520);
}

function download(){
  const a=document.createElement("a");
  a.download="SENA_PHOTOBOOTH.png";
  a.href=final.toDataURL();
  a.click();
}

function reset(){
  show("home");
}
</script>

</body>
</html>
